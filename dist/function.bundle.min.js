/*!
 * YCL public function Library by @YCL with MIT License
 * Built: 2025-10-09
 */
!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports):"function"==typeof define&&define.amd?define(["exports"],o):o((e="undefined"!=typeof globalThis?globalThis:e||self).__YCL_GLOBAL_EXPORTS__={})}(this,function(e){"use strict";function o(e){const o=window.location.search;if((!o||"?"===o)&&o&&0===o.indexOf("?")&&1===o.length)return!1;const r=new URLSearchParams(o);if(e){const o=r.get(e);return null===o?void 0:o}{const e={};for(const[o,t]of r.entries())e[o]=t;return e}}class r{static#e=new Map;static openDatabase(e,o){if(!("indexedDB"in window))return Promise.reject(new Error("IndexedDB is not supported in this environment."));if(this.#e.has(e))return this.#e.get(e);const r=new Promise((r,t)=>{const n=indexedDB.open(e,1);n.onupgradeneeded=e=>{const r=e.target.result;r.objectStoreNames.contains(o)||r.createObjectStore(o)},n.onsuccess=o=>{const t=o.target.result;t.onclose=()=>this.#e.delete(e),r(t)},n.onerror=o=>{this.#e.delete(e),t(new Error(`IndexedDB open error: ${o.target.error.name}`))}});return this.#e.set(e,r),r}static#o(e,o,r,t){return new Promise((n,s)=>{const i=e.transaction([o],r),c=i.objectStore(o),a=t(c);i.oncomplete=()=>n(a.result),i.onerror=e=>s(new Error(`Transaction error: ${e.target.error.name}`)),a.onerror=e=>s(new Error(`Request error: ${e.target.error.name}`))})}static async saveToIndexedDB(e,o,r,t){const n=await this.openDatabase(e,o);await this.#o(n,o,"readwrite",e=>e.put(t,r))}static async getFromIndexedDB(e,o,r){const t=await this.openDatabase(e,o);return this.#o(t,o,"readonly",e=>e.get(r))}}"undefined"!=typeof console&&console.log("\n+---------------------------------------------------------+\n\n         %co     o          %co o o          %co\n           %co o           %co               %co\n            %co           %co                %co\n            %co            %co               %co\n            %co             %co o o          %co o o o%c    \n     \n+--------------------------------------------------------+\n\n我们一日日度过的所谓的日常，实际上可能是接连不断的奇迹！--京阿尼《日常》","color:#ff0","color:#0f0","color:#0ff","color:#ff0","color:#0f0","color:#0ff","color:#ff0","color:#0f0","color:#0ff","color:#ff0","color:#0f0","color:#0ff","color:#ff0","color:#0f0","color:#0ff","color #fff"),e.DbgTimmer=class{#r=!1;#t=new Map;constructor(e=!1){this.#r=e}setEnable(e=!1){this.#r=e,this.#r||this.#t.clear()}Start(e="noname"){this.#r&&this.#t.set(e,performance.now())}Stop(e="noname",o=""){if(!this.#r)return;const r=this.#t.get(e);if(!r)return;const t=performance.now()-r;return"undefined"!=typeof console&&console.log(`${o||e}: %c${t.toFixed(3)}ms`,"color: #6495ed"),this.#t.delete(e),t}},e.IndexedDBControl=r,e.RandomString=function(e=32){const o=new Array(e);for(let r=0;r<e;r++)o[r]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return o.join("")},e.ServerChoose=async function(e,o=!1){if(!Array.isArray(e)||0===e.length)return o&&console.warn("TestURLs 数组为空或无效。"),[];const r=await Promise.all(e.map(async(e,o)=>{const r=new AbortController,t=performance.now();let n;const s=new Promise((e,o)=>{n=setTimeout(()=>{r.abort(),o(new Error("Timeout after 3000ms"))},3e3)});try{const i=`${e.endsWith("/")?e:e+"/"}test.bin`,c=fetch(i,{signal:r.signal}),a=await Promise.race([c,s]);if(clearTimeout(n),!a.ok)throw new Error(`HTTP Error: ${a.status} ${a.statusText||""}`);return await a.arrayBuffer(),{url:e,elapsedTime:performance.now()-t,isError:!1,error:null,index:o}}catch(r){return clearTimeout(n),{url:e,elapsedTime:performance.now()-t,isError:!0,error:r.message||r.toString(),index:o}}})),t=r.filter(e=>!e.isError),n=t.length>0?Math.min(...t.map(e=>e.elapsedTime)):1/0,s=r.map(e=>({url:e.url,elapsedTime:Number(e.elapsedTime.toFixed(2)),isError:e.isError,errorMessage:e.error,isFastest:!e.isError&&e.elapsedTime===n}));return o&&s.forEach(e=>{const o=e.isFastest?"#00ff7f":e.elapsedTime<1e3?"#ffff00":"#ffffff",r=e.isError?"#ff4500":"#32cd32";console.log(`%c[${e.isFastest?"FASTEST":"NORMAL"}] %cURL: ${e.url} | %c耗时: ${e.elapsedTime}ms | %c出错: ${e.isError}`,"font-weight: bold; color: "+(e.isFastest?"#00ff7f":"#1e90ff"),"color: #ffffff",`color: ${o}; font-weight: bold;`,`color: ${r}; font-weight: bold;`),e.isError&&console.log(`%c错误信息: ${e.errorMessage}`,"color:red")}),s},e.getUrlParams=o,e.isDebug=function(){const e=void 0!==o("debug"),r=/^localhost|^127(?:\.0(?:\.0(?:\.0?)?)?\.0?)|(?:0*:)?::1$/i.test(window.location.hostname);return e||r},e.isMobile=function(){const e=/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini|SymbianOS|Windows Phone|iPad/i.test(navigator.userAgent),o=window.innerWidth<768,r="ontouchstart"in window||navigator.maxTouchPoints>0;return e||r&&o},e.loadExternalResource=function(e,o,r=!1,t){if("undefined"==typeof document||!document.head){const e=new Error("loadExternalResource: Must be executed in a DOM environment.");return"function"==typeof t&&t(e),Promise.reject(e)}return new Promise((n,s)=>{let i;if("css"===o)i=document.createElement("link"),i.rel="stylesheet",i.href=e;else{if("js"!==o){const e=new Error(`loadExternalResource: Invalid type "${o}". Must be 'js' or 'css'.`);return"function"==typeof t&&t(e),s(e)}i=document.createElement("script"),r&&(i.type="module"),i.src=e,i.async=!0}i.onload=()=>{n(),"function"==typeof t&&t()},i.onerror=()=>{const r=new Error(`Failed to load resource: ${e} (Type: ${o})`);s(r),"function"==typeof t&&t(r)},document.head.appendChild(i)})}}),function(){if("undefined"!=typeof window){var e=window.__YCL_GLOBAL_EXPORTS__;if(e){for(var o in e)e.hasOwnProperty(o)&&(window[o]=e[o]);delete window.__YCL_GLOBAL_EXPORTS__}}}();
