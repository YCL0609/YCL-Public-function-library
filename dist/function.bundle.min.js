/*!
 * YCL public function Library by @YCL with MIT License
 * Built: 2025-10-11
 */
!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports):"function"==typeof define&&define.amd?define(["exports"],o):o((e="undefined"!=typeof globalThis?globalThis:e||self).__YCL_GLOBAL_EXPORTS__={})}(this,function(e){"use strict";function o(e){const o=window.location.search;if((!o||"?"===o)&&o&&0===o.indexOf("?")&&1===o.length)return!1;const r=new URLSearchParams(o);if(e){const o=r.get(e);return null===o?void 0:o}{const e={};for(const[o,n]of r.entries())e[o]=n;return e}}class r{static#e=new Map;static openDatabase(e,o){if(!("indexedDB"in window))return Promise.reject(new Error("IndexedDB is not supported in this environment."));if(this.#e.has(e))return this.#e.get(e);const r=new Promise((r,n)=>{const t=indexedDB.open(e,1);t.onupgradeneeded=e=>{const r=e.target.result;r.objectStoreNames.contains(o)||r.createObjectStore(o)},t.onsuccess=o=>{const n=o.target.result;n.onclose=()=>this.#e.delete(e),r(n)},t.onerror=o=>{this.#e.delete(e),n(new Error(`IndexedDB open error: ${o.target.error.name}`))}});return this.#e.set(e,r),r}static#o(e,o,r,n){return new Promise((t,s)=>{const i=e.transaction([o],r),a=i.objectStore(o),c=n(a);i.oncomplete=()=>t(c.result),i.onerror=e=>s(new Error(`Transaction error: ${e.target.error.name}`)),c.onerror=e=>s(new Error(`Request error: ${e.target.error.name}`))})}static async saveToIndexedDB(e,o,r,n){const t=await this.openDatabase(e,o);await this.#o(t,o,"readwrite",e=>e.put(n,r))}static async getFromIndexedDB(e,o,r){const n=await this.openDatabase(e,o);return this.#o(n,o,"readonly",e=>e.get(r))}}"undefined"!=typeof console&&console.log("\n+---------------------------------------------------------+\n\n         %co     o          %co o o          %co\n           %co o           %co               %co\n            %co           %co                %co\n            %co            %co               %co\n            %co             %co o o          %co o o o%c    \n     \n+--------------------------------------------------------+\n\n我们一日日度过的所谓的日常，实际上可能是接连不断的奇迹！--京阿尼《日常》","color:#ff0","color:#0f0","color:#0ff","color:#ff0","color:#0f0","color:#0ff","color:#ff0","color:#0f0","color:#0ff","color:#ff0","color:#0f0","color:#0ff","color:#ff0","color:#0f0","color:#0ff","color #fff"),e.DbgTimmer=class{#r=!1;#n=new Map;constructor(e=!1){this.#r=e}setEnable(e=!1){this.#r=e,this.#r||this.#n.clear()}Start(e="noname"){this.#r&&this.#n.set(e,performance.now())}Stop(e="noname",o=""){if(!this.#r)return;const r=this.#n.get(e);if(!r)return;const n=performance.now()-r;return"undefined"!=typeof console&&console.log(`${o||e}: %c${n}ms`,"color: #6495ed"),this.#n.delete(e),n}},e.IndexedDBControl=r,e.RandomString=function(e=32){const o=new Array(e);for(let r=0;r<e;r++)o[r]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return o.join("")},e.ServerChoose=async function(e,o=!1){if(!Array.isArray(e)||0===e.length)return o&&console.warn("TestURLs 数组为空或无效。"),[];const r=await Promise.all(e.map(async(e,o)=>{const r=new AbortController,n=performance.now();let t;const s=new Promise((e,o)=>{t=setTimeout(()=>{r.abort(),o(new Error("Timeout after 3000ms"))},3e3)});try{const i=`${e.endsWith("/")?e:e+"/"}test.bin`,a=fetch(i,{signal:r.signal}),c=await Promise.race([a,s]);if(clearTimeout(t),!c.ok)throw new Error(`HTTP Error: ${c.status} ${c.statusText||""}`);return await c.arrayBuffer(),{url:e,elapsedTime:performance.now()-n,isError:!1,error:null,index:o}}catch(r){return clearTimeout(t),{url:e,elapsedTime:performance.now()-n,isError:!0,error:r.message||r.toString(),index:o}}})),n=r.filter(e=>!e.isError),t=n.length>0?Math.min(...n.map(e=>e.elapsedTime)):1/0,s=r.map(e=>({url:e.url,elapsedTime:Number(e.elapsedTime.toFixed(2)),isError:e.isError,errorMessage:e.error,isFastest:!e.isError&&e.elapsedTime===t}));return o&&s.forEach(e=>{const o=e.isFastest?"#00ff7f":e.elapsedTime<1e3?"#ffff00":"#ffffff",r=e.isError?"#ff4500":"#32cd32";console.log(`%c[${e.isFastest?"FASTEST":"NORMAL"}] %cURL: ${e.url} | %c耗时: ${e.elapsedTime}ms | %c出错: ${e.isError}`,"font-weight: bold; color: "+(e.isFastest?"#00ff7f":"#1e90ff"),"color: #ffffff",`color: ${o}; font-weight: bold;`,`color: ${r}; font-weight: bold;`),e.isError&&console.log(`%c错误信息: ${e.errorMessage}`,"color:red")}),s},e.getUrlParams=o,e.isDebug=function(){const e=void 0!==o("debug"),r=/^localhost|^127(?:\.0(?:\.0(?:\.0?)?)?\.0?)|(?:0*:)?::1$/i.test(window.location.hostname);return e||r},e.isMobile=function(){const e=/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini|SymbianOS|Windows Phone|iPad/i.test(navigator.userAgent),o=window.innerWidth<768,r="ontouchstart"in window||navigator.maxTouchPoints>0;return e||r&&o},e.loadExternalResource=function(e,o,r=!1){if("undefined"==typeof document||!document.head){const e=new Error("loadExternalResource: Must be executed in DOM environment.");return Promise.reject(e)}return new Promise((n,t)=>{let s;if("css"===o)s=document.createElement("link"),s.rel="stylesheet",s.href=e;else{if("js"!==o){const e=new Error(`loadExternalResource: Invalid type "${o}".`);return t(e)}s=document.createElement("script"),r&&(s.type="module"),s.src=e,s.async=!0}s.onload=()=>n(),s.onerror=()=>{const o=new Error(`Failed to load resource: ${e}`);t(o)},document.head.appendChild(s)})}}),function(){if("undefined"!=typeof window){var e=window.__YCL_GLOBAL_EXPORTS__;if(e){for(var o in e)e.hasOwnProperty(o)&&(window[o]=e[o]);delete window.__YCL_GLOBAL_EXPORTS__}}}();
